---
name: fix
description: 接收用户修正反馈，执行修复并学习经验
args:
  - name: problem
    description: 问题描述（必需）
    required: true
---

# /auto-dev:fix 命令

接收用户修正反馈，执行修复并从中学习。

## 职责
- 接收用户反馈的问题
- 执行代码修正
- 触发经验学习
- 恢复执行流程

## 输入/输出
- **输入**: 问题描述（必需，用户反馈的具体问题）
- **输出**: 修复结果 + 可选的规则学习

## 用法

```
/auto-dev:fix "问题描述"
```

## 示例

```
/auto-dev:fix "登录后应该跳转首页而不是个人中心"
/auto-dev:fix "价格应该向下取整"
```

## 流程

### 1. 记录问题

**捕获当前上下文：**

关联当前任务执行上下文：
- 当前任务 ID 和描述
- 当前编辑的文件
- 执行状态

```
📝 收到修正反馈
任务: #3 实现用户登录功能
问题: 登录后应该跳转首页而不是个人中心
```

### 2. 执行修正

**根据问题描述修改代码：**

- 分析问题原因
- 定位需要修改的代码
- 执行修改
- 运行验证确认修复

```
🔧 执行修正...

修改文件: src/auth/login.ts
- 将跳转目标从 '/profile' 改为 '/'

🔍 验证中...
✅ 验证通过，登录后现在跳转到首页
```

### 3. 提取经验

**调用 learn-from-fix skill：**

调用 `auto-dev:learn-from-fix` 技能：
- 分析修正前后的代码差异
- 提取可泛化的业务规则
- 询问用户是否记录

```
💡 要记住这个规则吗？
   "用户登录成功后跳转首页"

[记住] [这次算了]
```

### 4. 继续执行

**检查 Ralph Loop 状态：**

- 若 Ralph Loop 仍在运行 → 自动继续下一迭代
  ```
  ▶️ 继续执行下一任务...
  ```

- 若 Ralph Loop 已停止 → 询问用户
  ```
  Ralph Loop 已停止，是否重新启动？
  [重新启动] [稍后处理]
  ```

