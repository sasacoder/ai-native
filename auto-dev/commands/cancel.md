---
name: cancel
description: 取消当前 Auto-Dev 执行
---

# /auto-dev:cancel 命令

安全取消当前自动化开发执行，保留已完成的工作。

## 职责
- 检查执行状态
- 显示确认对话框
- 安全停止执行
- 保留工作进度

## 输入/输出
- **输入**: 无
- **输出**: 取消结果

## 用法

```
/auto-dev:cancel
```

## 流程

### 1. 检查执行状态

检查 `.autodev/execution-state.json` 是否存在：
- 若不存在 → 输出"无活跃执行"并结束
- 若存在 → 继续步骤 2

### 2. 获取当前进度

调用 TaskMaster MCP 的 `get_tasks` 获取进度信息：
- 已完成任务数
- 总任务数
- 待执行任务数

### 3. 显示确认对话框

```
⚠️ 确认取消 Auto-Dev 执行？

当前进度:
- 已完成: 3/10 任务
- 待执行: 7 任务

取消后:
- ✅ 已完成的任务保留
- ✅ 代码变更保留
- ✅ Git 分支保留
- ❌ Ralph Loop 停止

[确认取消] [继续执行]
```

### 4. 执行取消

若用户确认：

1. **调用 Ralph Loop 取消**
   ```
   /ralph-loop:cancel-ralph
   ```

2. **清理状态文件**
   - 删除 `.autodev/execution-state.json`

3. **输出结果**
   ```
   ✅ 执行已取消

   保留内容:
   - 分支: feature/auto-dev-xxx
   - 已完成任务: 3/10
   - 代码变更: 已保留

   恢复执行: /auto-dev <设计文档>
   ```

### 5. 取消中止

若用户选择继续执行：

```
▶️ 继续执行...
```

## 无执行时的输出

```
ℹ️ 当前无活跃执行，无需取消
```

