---
name: learn-from-fix
description: 从修正中学习业务规则
---

# Learn From Fix Skill

从用户修正中提取和记录业务规则。

## 职责
- 分析修正前后的代码差异
- 提取可泛化的业务规则
- 询问用户是否记录
- 写入规则文件

## 输入/输出
- **输入**: 修正上下文（任务、问题描述、代码差异）
- **输出**: 规则记录结果

## 流程

### 1. 分析偏差

**对比修正前后的差异：**

分析代码变更：
- 识别关键的逻辑变化
- 理解变化的业务含义
- 提取可泛化的模式

```
📊 分析代码差异...

变更类型: 路由跳转
关键变化: '/profile' → '/'
业务含义: 用户期望登录后返回首页
```

### 2. 生成规则描述

**格式化规则：**

规则格式: "当遇到 [情况] 时，应该 [做法]"

确保规则：
- 足够具体，能指导实现
- 足够通用，能复用到类似场景

```
💡 提取规则:
   "当实现用户登录成功后的跳转时，应该跳转到首页而非个人中心"
```

### 3. 用户确认

**展示规则并询问：**

```
✅ 已修复，登录后现在跳转到首页

💡 要记住这个规则吗？
   "用户登录成功后跳转首页"

[记住] [这次算了]
```

等待用户选择：
- **记住** → 继续步骤 4
- **这次算了** → 跳过步骤 4，结束

### 4. 记录规则

**追加到 .autodev/rules.md：**

若用户选择记住，将规则写入文件：

```markdown
## [YYYY-MM-DD] 从任务 "任务标题" 学到的规则
- 规则: 当遇到 [情况] 时，应该 [做法]
- 原因: [用户反馈的问题描述]
- 相关文件: [涉及的文件路径]
```

**示例输出：**

```markdown
## 2024-01-15 从任务 "添加用户登录" 学到的规则
- 规则: 用户登录成功后跳转首页
- 原因: 用户反馈"登录后应该跳转首页而不是个人中心"
- 相关文件: src/auth/login.ts
```

```
✅ 规则已记录到 .autodev/rules.md
```

